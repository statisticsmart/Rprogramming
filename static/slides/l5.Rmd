---
title: "STA 326 2.0 Programming and Data Analysis with R"
subtitle: "Lesson 5: Writing Functions in R (Simulations)"
author: "Dr Thiyanga Talagala"
date: "2020-03-03"
output:
  xaringan::moon_reader:
    chakra: libs/remark-latest.min.js
    lib_dir: libs
    css: 
      - default
      - default-fonts
      - duke-blue
      - hygge-duke
      - libs/cc-fonts.css
      - libs/figure-captions.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

background-image: url('montyhall.jpg')
background-position: center
background-size: contain

# Monty Hall Problem

.footer-note[.tiny[.green[Image Credit: ][Ben Bennetts ](https://hollamhouse.files.wordpress.com/2016/08/monty-hall-1.jpg)]]


---

background-image: url('mstep1.png')
background-position: center
background-size: contain
---

background-image: url('mstep2.png')
background-position: center
background-size: contain
---

# Monty Hall Problem: Rules

- The host must always open a door that was not picked by the contestant.

--

- The host must always open a door to reveal a goat and never the car.

--

- The host must always offer the chance to switch between the originally chosen door and the remaining closed door.

             Taken from https://en.wikipedia.org/wiki/Monty_Hall_problem

---
class: center, middle, duke-orange

# Let's play the game!

Click here to play: http://www.math.ucsd.edu/~crypto/Monty/monty.html

# Does switching increases the chance of winning the car?

---

background-image: url('stayswap.png')
background-position: center
background-size: contain

---

We use `sample` function to assign `car`, `goat`, `goat`, behind the doors.

```{r, comment=NA}
sample(c("car", "goat", "goat"))

sample(c("car", "goat", "goat"))
```

--
Here is a function that will take player's initial choice of door.

```{r, comment=NA}
select_first_door <- function(door){
  door.allocation <- sample(c("car", "goat", "goat"))
  door.allocation[door]
}

select_first_door(2) # My first choice is the 2nd door
```

--

Modify your function so that it shows the player the door that the host selects. Hint: `sample` function act as a host.

---

Modify your function so that it includes the player strategy (switch or stay) as an input, and returns the appropriate result.

- Run your function 1000 times, for each strategy and report the proportion of times that car is selected. (You could put this
in a loop and compute the proportion of times car shows.) 
- How many times would you expect car to be selected out of 1000 runs? 

---


Write a function to simulate the flip a coin $n$ times, keeping track of the individual outcomes (1 = heads, 0 = tails) in a vector that
you preallocte. Assume $P(H)=0.5$.

Example output:

```{r, comment=NA, echo=FALSE}
flip_coin <- function(n){
  out <- numeric(n)
  for (i in 1:n){
    coin.out <- rbinom(1, p=0.5, n=1)
    if(coin.out==1){
      out[i] <- "H"
    } else {
      out[i] <- "T"
    }
  }
  out
}

```

```{r, comment=NA}
flip_coin(10)
```


---
```{r, comment=NA}
flip_coin <- function(n){
  out <- numeric(n)
  for (i in 1:n){
    coin.out <- rbinom(1, p=0.5, n=1)
    if(coin.out==1){
      out[i] <- "H"
    } else {
      out[i] <- "T"
    }
  }
  out
}

```

```{r, comment=NA}
flip_coin(10)
```

---


---

Write a function to prints out standard random normal numbers (use rnorm()) but stops (breaks) if you get a number bigger than 1.


---

Using next adapt the loop from last exercise so that doesnâ€™t print negative numbers.

---
Write a function to simulate the flip a coin $n$ times, keeping track of the individual outcomes (1 = heads, 0 = tails) in a vector that
you preallocte. Assume $P(H)=0.5$.

Example output:

```{r, comment=NA, echo=FALSE}
flip_coin <- function(n){
  out <- numeric(n)
  for (i in 1:n){
    coin.out <- rbinom(1, p=0.5, n=1)
    if(coin.out==1){
      out[i] <- "H"
    } else {
      out[i] <- "T"
    }
  }
  out
}

```

```{r, comment=NA}
flip_coin(10)
```


---
```{r, comment=NA}
flip_coin <- function(n){
  out <- numeric(n)
  for (i in 1:n){
    coin.out <- rbinom(1, p=0.5, n=1)
    if(coin.out==1){
      out[i] <- "H"
    } else {
      out[i] <- "T"
    }
  }
  out
}

```

```{r, comment=NA}
flip_coin(10)
```

---